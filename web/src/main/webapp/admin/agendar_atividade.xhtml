<!DOCTYPE html [
    <!ENTITY nbsp "&#160;"> 
]>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:jsf="http://xmlns.jcp.org/jsf"
    xmlns:c="http://java.sun.com/jstl/core"
    xmlns:pe="http://primefaces.org/ui/extensions"
    template="layoutLogado.xhtml">

	<ui:define name="conteudo">
		<p:panel id="basic" header="Agendar atividade" style="margin-bottom:20px">
			<h:form prependId="false">
				<p:messages id="messages" showDetail="false" autoUpdate="true" closable="true"/>
				<div class="row">
					<div class="col-md-12">
						<p:fieldset style="margin-bottom:20px" styleClass="">
							<h:inputHidden id="idUsuario" value="#{agendarAtividadeMB.atividade.usuario.id}" />
							<legend>Usuário</legend>
							<div class="col-lg-3">
								<div class="form-group">
									<label for="login">Login *</label>
									<p:inputText id="login" name="login" type="text" class="form-control" placeholder="Login" value="#{agendarAtividadeMB.atividade.usuario.login}" required="true"/>
									<pe:keyFilter regEx="/[a-z0-9_]/i" for="login"/>				 
								</div>
							</div>
							
							<div class="col-lg-3">
								<div class="form-group">
									<label for="nome">Nome</label>
									<input id="nome" name="nome" type="text" class="form-control" placeholder="Nome" jsf:value="#{agendarAtividadeMB.atividade.usuario.nome}" disabled="disabled" readonly="readonly"/>				 
								</div>
							</div>
							
							<div class="col-lg-3">
								<div class="form-group">
									<label for="email">Email</label>
									<input id="email" name="email" type="text" class="form-control" placeholder="E-mail" jsf:value="#{agendarAtividadeMB.atividade.usuario.email}" disabled="disabled" readonly="readonly"/>				 
								</div>
							</div>
							
							<div class="col-lg-3">
								<div class="form-group">
									<label for="perfil">Perfil</label>
									<input id="perfil" name="perfil" type="text" class="form-control" placeholder="Perfil" jsf:value="#{agendarAtividadeMB.atividade.usuario.perfil.nome}" disabled="disabled" readonly="readonly"/>				 
								</div>
							</div>
							
							<div class="col-md-9">
								<div class="form-group">
								</div>
							</div>
							
							<div class="col-md-3">
								<div class="form-group">
									<h:commandLink id="btn-usuarios" class="btn btn-primary" actionListener="#{agendarAtividadeMB.abrirDialog}" style="width: 100%; color:white;" immediate="true">
										<i class="glyphicon glyphicon-search"></i>&nbsp;Usuários&nbsp;
									</h:commandLink>
								</div>
							</div>
						</p:fieldset>
					</div>
					
					<div class="col-md-6">
						<p:fieldset style="margin-bottom:20px" styleClass="">
							<legend>Descrição da atividade *</legend>
							<div class="form-group">
								<p:editor id="editor" widgetVar="editorWidget" value="#{agendarAtividadeMB.atividade.texto}" maxlength="3500" required="true" requiredMessage="O campo descrição da atividade é obrigatório"/>
							</div>
						</p:fieldset>
					</div>
					
					<div class="col-md-6">
						<p:fieldset style="margin-bottom:20px" styleClass="">
							<legend>Data do agendamento *</legend>
							<div class="form-group">
			        			<p:calendar id="data" value="#{agendarAtividadeMB.atividade.dataAgendamento}" pattern="dd-MM-yyyy" mask="true" locale="pt" mindate="#{agendarAtividadeMB.todayDate}" 
			        				required="true" requiredMessage="O campo data do agendamento é obrigatório"/>
		        			</div>
	        			</p:fieldset>
        			</div>
        			
        			<div class="col-lg-12">
						<div class="form-group">
							<div class="required">* Campos obrigatórios</div>
						</div>
					</div>
				</div>
	     		<div class="row">	
					<div class="col-md-3">
						<div class="form-group">
							<h:commandLink id="btn-signup" class="btn btn-primary" actionListener="#{agendarAtividadeMB.solicitarCadastroAtividade}" update="table-users, data" style="width: 100%; color:white;">
								<i class="glyphicon glyphicon-saved"></i>&nbsp;Cadastrar agendamento&nbsp;
							</h:commandLink>
						</div>
					</div>
					<div class="col-md-3">
						<div class="form-group">
							<a id="btn-cancel" class="btn btn-danger" href="#{request.contextPath}/admin/layoutLogado.xhtml" style="width: 100%; color:white;">
								<i class="glyphicon glyphicon-remove"></i>&nbsp;Cancelar&nbsp;
							</a>
						</div>
					</div>
				</div>
			</h:form>
		</p:panel>
		
		
		<p:dialog widgetVar="dlgConsultaUsuario" width="800" showHeader="false" resizable="false" modal="true">
			<h:form prependId="false">
				<p:messages id="dlgMessages" for="Message2" showDetail="false" autoUpdate="true" closable="true"/>
				<div class="form-group">
					<div class="row">
						<div class="col-md-4">
							<div class="form-group">
								<label for="dlgLogin">Login:</label>
								<input id="dlgLogin" name="dlgLogin" type="text" class="form-control" placeholder="Login" jsf:value="#{agendarAtividadeMB.login}" maxlength="25" />
							</div>
						</div>
						<div class="col-md-4">
							<div class="form-group">
								<label for="dlgPerfil">Perfil</label>
								<h:selectOneMenu id="dlgPerfil" value="#{agendarAtividadeMB.perfilId}" styleClass="form-control">
					                <f:selectItem itemLabel="[Selecione]" itemValue="" noSelectionOption="true" />
					                <f:selectItem itemLabel="Administrador" itemValue="1" noSelectionOption="false" />
					                <f:selectItem itemLabel="Gestor" itemValue="2" noSelectionOption="false" />
					                <f:selectItem itemLabel="Gerente" itemValue="3" noSelectionOption="false" />
					                <f:selectItem itemLabel="Operador" itemValue="4" noSelectionOption="false" />
				            	</h:selectOneMenu>
							</div>
						</div>
						<div class="col-md-4">
							<div class="form-group">
								<label>&nbsp;</label>
								<h:commandLink id="btn-pesquisar" class="btn btn-primary" actionListener="#{agendarAtividadeMB.consultarUsuario}" update="table-users" style="width: 100%; color:white;" immediate="false">
									<i class="glyphicon glyphicon-search"></i>&nbsp;Pesquisar&nbsp;
								</h:commandLink>
							</div>
						</div>
						
						<div class="col-md-12">
							<div class="form-group">
								<p:dataTable tableStyleClass="table-hover" id="table-users" var="user" value="#{agendarAtividadeMB.listUsuarios}" rows="5" paginator="true" paginatorPosition="bottom"
									paginatorAlwaysVisible="false" rowsPerPageTemplate="5,10" >
									<p:column style="width:64px; text-align: center" headerText="">
										<p:commandButton icon="ui-icon-arrowthick-1-e" title="Selecionar" actionListener="#{agendarAtividadeMB.selecionarUsuario(user.id)}" update="@all" />
									</p:column>
									<p:column headerText="Login">
										<h:outputText id="userLogin" value="#{user.login}" />
									</p:column>
									
									<p:column headerText="Perfil">
										<h:outputText id="userPerfil" value="#{user.perfil.nome}" />
					            	</p:column>
								</p:dataTable>
							</div>
						</div>
								
						<div class="col-md-9">
							<div class="form-group">
							</div>
						</div>
							
						<div class="col-md-3">
							<div class="form-group">
								<h:commandLink id="btn-cancel" class="btn btn-danger" actionListener="#{agendarAtividadeMB.fecharDialog}" update="table-users" style="width: 100%; color:white;" immediate="false">
									<i class="glyphicon glyphicon-remove"></i>&nbsp;Cancelar&nbsp;
								</h:commandLink>
							</div>
						</div>
					</div>
				</div>
			</h:form>
		</p:dialog>
		
		
	</ui:define>

</ui:composition>